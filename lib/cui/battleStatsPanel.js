// Generated by CoffeeScript 1.8.0
(function() {
  _cui.BattleStatsPanel = (function() {
    function BattleStatsPanel(ui) {
      this.ui = ui;
      this.panel = $('.battle-stats-panel');
    }

    BattleStatsPanel.prototype.init = function(battle) {
      var fillHalf;
      fillHalf = (function(_this) {
        return function(unit, unitName) {
          var img, imgSrc, multEl, nTurns, nameCell, statType, td, value, _i, _len, _ref, _results;
          nameCell = _this.panel.find("." + unitName + "-name");
          nameCell.find('span').text(unit.name);
          imgSrc = unit.equipped.getImagePath();
          nameCell.find('img.weapon').attr('src', imgSrc);
          if (unit.advantage === true) {
            imgSrc = "images/up_arrow.png";
          } else if (unit.advantage === false) {
            imgSrc = "images/down_arrow.png";
          } else {
            imgSrc = null;
          }
          img = nameCell.find('img.weapon-arrow');
          if (imgSrc != null) {
            img.attr('src', imgSrc).show();
          } else {
            img.hide();
          }
          _ref = ['hp', 'hit', 'dmg', 'crt'];
          _results = [];
          for (_i = 0, _len = _ref.length; _i < _len; _i++) {
            statType = _ref[_i];
            if (statType === 'hp') {
              value = unit.hp;
            } else {
              value = unit.battleStats[statType];
            }
            if (value != null) {
              value = Math.round(value);
            } else {
              value = '---';
            }
            td = _this.panel.find("." + unitName + "-" + statType);
            td.find('.stat').text(value);
            multEl = td.find('.multiplier');
            nTurns = battle.nTurns[unitName];
            if (statType === 'dmg' && nTurns > 1) {
              multEl.find('.number').text(nTurns);
              if (nTurns === 4) {
                multEl.addClass('x4');
              } else {
                multEl.removeClass('x4');
              }
              _results.push(multEl.show());
            } else {
              _results.push(multEl.hide());
            }
          }
          return _results;
        };
      })(this);
      fillHalf(battle.atk, 'atk');
      fillHalf(battle.def, 'def');
      return this.show();
    };

    BattleStatsPanel.prototype.show = function() {
      return this.panel.css('display', 'inline-block');
    };

    BattleStatsPanel.prototype.hide = function() {
      return this.panel.css('display', 'none');
    };

    return BattleStatsPanel;

  })();

}).call(this);
